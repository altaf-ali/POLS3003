<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Solutions | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.2.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../../week5/index.html" />
    
    
    <link rel="prev" href="../../ISLR/chapter4/lab.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="5.1.2" data-basepath="../.." data-revision="Mon Aug 03 2015 17:32:12 GMT+0100 (BST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="week1/index.html">
            
            <span><b>1.</b> Week 1</span>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="week2/index.html">
            
            <span><b>2.</b> Week 2</span>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="week3/index.html">
            
                
                    <a href="../../week3/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Week 3
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="week3/index.html">
            
                
                    <a href="../../week3/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Chapter 5. Resampling Methods
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="ISLR/chapter5/lab.html">
            
                
                    <a href="../../ISLR/chapter5/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="ISLR/chapter5/solutions.html">
            
                
                    <a href="../../ISLR/chapter5/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="week4/index.html">
            
                
                    <a href="../../week4/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Week 4
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="week4/index.html">
            
                
                    <a href="../../week4/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Chapter 3. Linear Regression
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="ISLR/chapter3/lab.html">
            
                
                    <a href="../../ISLR/chapter3/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="ISLR/chapter3/solutions.html">
            
                
                    <a href="../../ISLR/chapter3/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="week5/index.html">
            
                
                    <a href="../../week5/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Week 5
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="week4/index.html">
            
                
                    <a href="../../week4/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Chapter 4. Classification
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="ISLR/chapter4/lab.html">
            
                
                    <a href="../../ISLR/chapter4/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="5.1.2" data-path="ISLR/chapter4/solutions.html">
            
                
                    <a href="../../ISLR/chapter4/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="week5/index.html">
            
                
                    <a href="../../week5/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Chapter 7. Moving Beyond Linearity
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="ISLR/chapter7/lab.html">
            
                
                    <a href="../../ISLR/chapter7/lab.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.1.</b>
                        
                        Lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="ISLR/chapter7/solutions.html">
            
                
                    <a href="../../ISLR/chapter7/solutions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.2.</b>
                        
                        Solutions
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="week6/index.html">
            
            <span><b>6.</b> Week 6</span>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="week7/index.html">
            
            <span><b>7.</b> Week 7</span>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="week8/index.html">
            
            <span><b>8.</b> Week 8</span>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="week9/index.html">
            
            <span><b>9.</b> Week 9</span>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="week10/index.html">
            
            <span><b>10.</b> Week 10</span>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" ></a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="4-7-exercises">4.7 Exercises</h2>
<h3 id="exercise-10">Exercise 10</h3>
<pre><code class="lang-r">save_plots &lt;- <span class="hljs-literal">F</span>

<span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;ISLR&quot;</span>)
<span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;MASS&quot;</span>)
<span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;class&quot;</span>)

set.seed(<span class="hljs-number">0</span>)

<span class="hljs-comment"># Part (a):</span>
Direction &lt;- Weekly$Direction
Weekly$Direction &lt;- <span class="hljs-literal">NULL</span>
Weekly$NumericDirection &lt;- as.numeric(Direction)  <span class="hljs-comment"># Maps Down=&gt;1 and Up=&gt;2</span>
Weekly$NumericDirection[Weekly$NumericDirection == <span class="hljs-number">1</span>] &lt;- -<span class="hljs-number">1</span>  <span class="hljs-comment"># Maps Down=&gt;-1 and Up=&gt;2</span>
Weekly$NumericDirection[Weekly$NumericDirection == <span class="hljs-number">2</span>] &lt;- +<span class="hljs-number">1</span>  <span class="hljs-comment"># Maps Down=&gt;-1 and Up=&gt;+1</span>

<span class="hljs-comment"># Look at the correlation between the output and the input lags:</span>
Weekly.cor &lt;- cor(Weekly)

<span class="hljs-comment"># b: logistic regression to predict Direction as a function of 5 lag variables + volume:</span>
Weekly$NumericDirection &lt;- <span class="hljs-literal">NULL</span>
Weekly$Direction &lt;- Direction

five_lag_model &lt;- glm(Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data = Weekly, family = binomial)
summary(five_lag_model)
</code></pre>
<pre><code>## 
## Call:
## glm(formula = Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + 
##     Volume, family = binomial, data = Weekly)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6949  -1.2565   0.9913   1.0849   1.4579  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)  0.26686    0.08593   3.106   0.0019 **
## Lag1        -0.04127    0.02641  -1.563   0.1181   
## Lag2         0.05844    0.02686   2.175   0.0296 * 
## Lag3        -0.01606    0.02666  -0.602   0.5469   
## Lag4        -0.02779    0.02646  -1.050   0.2937   
## Lag5        -0.01447    0.02638  -0.549   0.5833   
## Volume      -0.02274    0.03690  -0.616   0.5377   
## ---
## Signif. codes:  0 &apos;***&apos; 0.001 &apos;**&apos; 0.01 &apos;*&apos; 0.05 &apos;.&apos; 0.1 &apos; &apos; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1496.2  on 1088  degrees of freedom
## Residual deviance: 1486.4  on 1082  degrees of freedom
## AIC: 1500.4
## 
## Number of Fisher Scoring iterations: 4
</code></pre><pre><code class="lang-r">contrasts(Weekly$Direction)
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r"><span class="hljs-comment"># c: the confusion matrix:</span>
p_hat &lt;- predict(five_lag_model, newdata = Weekly, type = <span class="hljs-string">&quot;response&quot;</span>)
y_hat &lt;- rep(<span class="hljs-string">&quot;Down&quot;</span>, length(p_hat))
y_hat[p_hat &gt; <span class="hljs-number">0.5</span>] &lt;- <span class="hljs-string">&quot;Up&quot;</span>
CM &lt;- table(predicted = y_hat, truth = Weekly$Direction)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">Down</th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">54</td>
<td style="text-align:right">48</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">430</td>
<td style="text-align:right">557</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LR (all features): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LR (all features): overall fraction correct=   0.561065&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># d: logistic regression using only Lag2 as the predictor (since it is the most significant predictor)</span>
Weekly.train &lt;- (Weekly$Year &gt;= <span class="hljs-number">1990</span>) &amp; (Weekly$Year &lt;= <span class="hljs-number">2008</span>)  <span class="hljs-comment"># our training set </span>
Weekly.test &lt;- (Weekly$Year &gt;= <span class="hljs-number">2009</span>)  <span class="hljs-comment"># our testing set </span>
lag2_model &lt;- glm(Direction ~ Lag2, data = Weekly, family = binomial, subset = Weekly.train)

<span class="hljs-comment"># CM on test data :</span>
p_hat &lt;- predict(lag2_model, newdata = Weekly[Weekly.test, ], type = <span class="hljs-string">&quot;response&quot;</span>)
y_hat &lt;- rep(<span class="hljs-string">&quot;Down&quot;</span>, length(p_hat))
y_hat[p_hat &gt; <span class="hljs-number">0.5</span>] &lt;- <span class="hljs-string">&quot;Up&quot;</span>
CM &lt;- table(predicted = y_hat, truth = Weekly[Weekly.test, ]$Direction)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">Down</th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">9</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">34</td>
<td style="text-align:right">56</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LR (only Lag2): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LR (only Lag2): overall fraction correct=   0.625000&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># e: Use LDA</span>
lda.fit &lt;- lda(Direction ~ Lag2, data = Weekly, subset = Weekly.train)

lda.predict &lt;- predict(lda.fit, newdata = Weekly[Weekly.test, ])
CM &lt;- table(predicted = lda.predict$class, truth = Weekly[Weekly.test, ]$Direction)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">Down</th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">9</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">34</td>
<td style="text-align:right">56</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LDA (only Lag2): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LDA (only Lag2): overall fraction correct=   0.625000&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># f: Use QDA</span>
qda.fit &lt;- qda(Direction ~ Lag2, data = Weekly, subset = Weekly.train)

qda.predict &lt;- predict(qda.fit, newdata = Weekly[Weekly.test, ])
CM &lt;- table(predicted = qda.predict$class, truth = Weekly[Weekly.test, ]$Direction)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">Down</th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">43</td>
<td style="text-align:right">61</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;QDA (only Lag2): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;QDA (only Lag2): overall fraction correct=   0.586538&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># g: KNN</span>
X.train &lt;- data.frame(Lag2 = Weekly[Weekly.train, ]$Lag2)
Y.train &lt;- Weekly[Weekly.train, ]$Direction

X.test &lt;- data.frame(Lag2 = Weekly[Weekly.test, ]$Lag2)

y_hat_k_1 &lt;- knn(X.train, X.test, Y.train, k = <span class="hljs-number">1</span>)

CM &lt;- table(predicted = y_hat_k_1, truth = Weekly[Weekly.test, ]$Direction)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">Down</th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">21</td>
<td style="text-align:right">29</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">22</td>
<td style="text-align:right">32</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;KNN (k=1): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;KNN (k=1): overall fraction correct=   0.509615&quot;
</code></pre><pre><code class="lang-r">y_hat_k_3 &lt;- knn(X.train, X.test, Y.train, k = <span class="hljs-number">3</span>)
CM &lt;- table(predicted = y_hat_k_3, truth = Weekly[Weekly.test, ]$Direction)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">Down</th>
<th style="text-align:right">Up</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Down</td>
<td style="text-align:right">15</td>
<td style="text-align:right">19</td>
</tr>
<tr>
<td style="text-align:left">Up</td>
<td style="text-align:right">28</td>
<td style="text-align:right">42</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;KNN (k=1): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;KNN (k=1): overall fraction correct=   0.548077&quot;
</code></pre><h3 id="exercise-11">Exercise 11</h3>
<pre><code class="lang-r"><span class="hljs-keyword">attach</span>(Auto)
</code></pre>
<pre><code>## The following objects are masked from Auto (pos = 5):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 8):
## 
##     acceleration, cylinders, displacement, horsepower, name,
##     origin, weight, year
## 
## The following object is masked from Wage (pos = 9):
## 
##     year
## 
## The following objects are masked from Auto (pos = 10):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 13):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 16):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 17):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following object is masked from Wage (pos = 18):
## 
##     year
## 
## The following objects are masked from Auto (pos = 19):
## 
##     acceleration, cylinders, displacement, horsepower, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 20):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 23):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following object is masked from Wage (pos = 26):
## 
##     year
## 
## The following objects are masked from Auto (pos = 27):
## 
##     acceleration, cylinders, displacement, horsepower, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 28):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 31):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following object is masked from Wage (pos = 41):
## 
##     year
## 
## The following objects are masked from Auto (pos = 42):
## 
##     acceleration, cylinders, displacement, horsepower, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 43):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 47):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
## 
## The following objects are masked from Auto (pos = 53):
## 
##     acceleration, cylinders, displacement, horsepower, mpg, name,
##     origin, weight, year
</code></pre><pre><code class="lang-r">set.seed(<span class="hljs-number">0</span>)

<span class="hljs-comment"># Part (a):</span>
mpg01 &lt;- rep(<span class="hljs-number">0</span>, dim(Auto)[<span class="hljs-number">1</span>])  <span class="hljs-comment"># 0 =&gt; less than the median of mpg </span>
mpg01[Auto$mpg &gt; median(Auto$mpg)] &lt;- <span class="hljs-number">1</span>  <span class="hljs-comment"># 1 =&gt; greater than the median of mpg </span>

Auto$mpg01 &lt;- mpg01
Auto$mpg &lt;- <span class="hljs-literal">NULL</span>

<span class="hljs-comment"># Part (b):</span>
pairs(Auto)
</code></pre>
<p><img src="figure/unnamed-chunk-2-1.png" alt="plot of chunk unnamed-chunk-2"> </p>
<pre><code class="lang-r">Auto$mpg01 &lt;- as.factor(mpg01)

<span class="hljs-comment"># Part (c):</span>
n &lt;- dim(Auto)[<span class="hljs-number">1</span>]
inds.train &lt;- sample(<span class="hljs-number">1</span>:n, <span class="hljs-number">3</span> * n/<span class="hljs-number">4</span>)
Auto.train &lt;- Auto[inds.train, ]
inds.test &lt;- (<span class="hljs-number">1</span>:n)[-inds.train]
Auto.test &lt;- Auto[inds.test, ]

<span class="hljs-comment"># Part (d) Use LDA:</span>
lda.fit &lt;- lda(mpg01 ~ cylinders + displacement + weight, data = Auto.train)

lda.predict &lt;- predict(lda.fit, newdata = Auto.test)
CM &lt;- table(predicted = lda.predict$class, truth = Auto.test$mpg01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">42</td>
<td style="text-align:right">1</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">50</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LDA: overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LDA: overall fraction correct=   0.938776&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># Part (e): Use QDA:</span>
qda.fit &lt;- qda(mpg01 ~ cylinders + displacement + weight, data = Auto.train)

qda.predict &lt;- predict(qda.fit, newdata = Auto.test)
CM &lt;- table(predicted = qda.predict$class, truth = Auto.test$mpg01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">44</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">49</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;QDA: overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;QDA: overall fraction correct=   0.948980&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># Part (f): Use Logistic regression:</span>
lr.fit &lt;- glm(mpg01 ~ cylinders + displacement + weight, data = Auto.train, family = binomial)

p_hat &lt;- predict(lr.fit, newdata = Auto.test, type = <span class="hljs-string">&quot;response&quot;</span>)
y_hat &lt;- rep(<span class="hljs-number">0</span>, length(p_hat))
y_hat[p_hat &gt; <span class="hljs-number">0.5</span>] &lt;- <span class="hljs-number">1</span>
CM &lt;- table(predicted = as.factor(y_hat), truth = Auto.test$mpg01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">43</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">48</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LR (all features): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LR (all features): overall fraction correct=   0.928571&quot;
</code></pre><h3 id="exercise-12">Exercise 12</h3>
<pre><code class="lang-r"><span class="hljs-comment"># Part (a):</span>
Power &lt;- <span class="hljs-keyword">function</span>() {
    print(<span class="hljs-number">2</span>^<span class="hljs-number">3</span>)
}

<span class="hljs-comment"># Part (b):</span>
Power2 &lt;- <span class="hljs-keyword">function</span>(x, a) {
    print(x^a)
}
</code></pre>
<h3 id="exercise-13">Exercise 13</h3>
<pre><code class="lang-r">set.seed(<span class="hljs-number">0</span>)

n &lt;- dim(Boston)[<span class="hljs-number">1</span>]

<span class="hljs-comment"># Introduce a variable whether or not the crime rate is above=1 / below=0 the median</span>
Boston$crim01 &lt;- rep(<span class="hljs-number">0</span>, n)
Boston$crim01[Boston$crim &gt;= median(Boston$crim)] &lt;- <span class="hljs-number">1</span>
Boston$crim &lt;- <span class="hljs-literal">NULL</span>

<span class="hljs-comment"># Look to see what features are most strongly correlated with crim01:</span>
Boston.cor &lt;- cor(Boston)
print(sort(Boston.cor[, <span class="hljs-string">&quot;crim01&quot;</span>]))
</code></pre>
<pre><code>##         dis          zn       black        medv          rm        chas 
## -0.61634164 -0.43615103 -0.35121093 -0.26301673 -0.15637178  0.07009677 
##     ptratio       lstat       indus         tax         age         rad 
##  0.25356836  0.45326273  0.60326017  0.60874128  0.61393992  0.61978625 
##         nox      crim01 
##  0.72323480  1.00000000
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># Split the data set into testing and training parts:</span>
inds.train &lt;- sample(<span class="hljs-number">1</span>:n, <span class="hljs-number">3</span> * n/<span class="hljs-number">4</span>)
inds.test &lt;- (<span class="hljs-number">1</span>:n)[-inds.train]
Boston.train &lt;- Boston[inds.train, ]
Boston.test &lt;- Boston[inds.test, ]

<span class="hljs-comment"># Fit several models to the training data</span>
lr_model &lt;- glm(crim01 ~ nox + rad + dis, data = Boston.train, family = binomial)

p_hat &lt;- predict(lr_model, newdata = Boston.test, type = <span class="hljs-string">&quot;response&quot;</span>)
y_hat &lt;- rep(<span class="hljs-number">0</span>, length(p_hat))
y_hat[p_hat &gt; <span class="hljs-number">0.5</span>] &lt;- <span class="hljs-number">1</span>
CM &lt;- table(predicted = y_hat, truth = Boston.test$crim01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">56</td>
<td style="text-align:right">15</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">4</td>
<td style="text-align:right">52</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LR: overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LR: overall fraction correct=   0.850394&quot;
</code></pre><pre><code class="lang-r">lda.fit &lt;- lda(crim01 ~ nox + rad + dis, data = Boston.train)

<span class="hljs-comment"># Use LDA</span>
lda.fit &lt;- lda(crim01 ~ nox + rad + dis, data = Boston.train)

lda.predict &lt;- predict(lda.fit, newdata = Boston.test)
CM &lt;- table(predicted = lda.predict$class, truth = Boston.test$crim01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">57</td>
<td style="text-align:right">21</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">46</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;LDA: overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;LDA: overall fraction correct=   0.811024&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># f: Use QDA</span>
qda.fit &lt;- qda(crim01 ~ nox + rad + dis, data = Boston.train)

qda.predict &lt;- predict(qda.fit, newdata = Boston.test)
CM &lt;- table(predicted = qda.predict$class, truth = Boston.test$crim01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">58</td>
<td style="text-align:right">22</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">45</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;QDA: overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;QDA: overall fraction correct=   0.811024&quot;
</code></pre><pre><code class="lang-r"><span class="hljs-comment"># g: KNN</span>
X.train &lt;- Boston.train
X.train$crim01 &lt;- <span class="hljs-literal">NULL</span>
Y.train &lt;- Boston.train$crim01

X.test &lt;- Boston.test
X.test$crim01 &lt;- <span class="hljs-literal">NULL</span>

y_hat_k_1 &lt;- knn(X.train, X.test, Y.train, k = <span class="hljs-number">1</span>)

CM &lt;- table(predicted = y_hat_k_1, truth = Boston.test$crim01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">59</td>
<td style="text-align:right">9</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">58</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;KNN (k=1): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;KNN (k=1): overall fraction correct=   0.921260&quot;
</code></pre><pre><code class="lang-r">y_hat_k_3 &lt;- knn(X.train, X.test, Y.train, k = <span class="hljs-number">3</span>)
CM &lt;- table(predicted = y_hat_k_3, truth = Boston.test$crim01)
CM
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">predicted/truth</th>
<th style="text-align:right">0</th>
<th style="text-align:right">1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:right">58</td>
<td style="text-align:right">10</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">57</td>
</tr>
</tbody>
</table>
<pre><code class="lang-r">sprintf(<span class="hljs-string">&quot;KNN (k=3): overall fraction correct= %10.6f&quot;</span>, (CM[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] + CM[<span class="hljs-number">2</span>, <span class="hljs-number">2</span>])/sum(CM))
</code></pre>
<pre><code>## [1] &quot;KNN (k=3): overall fraction correct=   0.905512&quot;
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../ISLR/chapter4/lab.html" class="navigation navigation-prev " aria-label="Previous page: Lab"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../week5/index.html" class="navigation navigation-next " aria-label="Next page: Chapter 7. Moving Beyond Linearity"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
